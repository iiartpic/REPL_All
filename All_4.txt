let
    Источник = Folder.Files(""),
    #"Добавлен пользовательский объект" = Table.AddColumn(Источник, "Пользовательская", each AllFiles([Folder Path]&[Name])),
    #"Другие удаленные столбцы" = Table.SelectColumns(#"Добавлен пользовательский объект",{"Name", "Пользовательская"}),
    #"Замененное значение" = Table.ReplaceValue(#"Другие удаленные столбцы",".xlsx","",Replacer.ReplaceText,{"Name"}),
    #"Развернутый элемент Пользовательская" = Table.ExpandTableColumn(#"Замененное значение", "Пользовательская", {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9"}, {"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8", "Column9"}),
    #"Переименованные столбцы" = Table.RenameColumns(#"Развернутый элемент Пользовательская",{{"Name", "Журнал"}, {"Column1", "Артикул"}, {"Column2", "Наименование"}, {"Column3", "Количество"}, {"Column9", "Адрес"}}),
    #"Другие удаленные столбцы1" = Table.SelectColumns(#"Переименованные столбцы",{"Журнал", "Артикул", "Наименование", "Количество", "Адрес"}),
    #"Строки с примененным фильтром" = Table.SelectRows(#"Другие удаленные столбцы1", each [Наименование] <> null),
    #"Строки с примененным фильтром1" = Table.SelectRows(#"Строки с примененным фильтром", each [Артикул] <> "Item No."),
    #"Дублированный столбец1" = Table.DuplicateColumn(#"Строки с примененным фильтром1", "Адрес", "Копия Адрес"),
    #"Переименованные столбцы1" = Table.RenameColumns(#"Дублированный столбец1",{{"Копия Адрес", "Уровень"}}),
    #"Разделить столбец по положению" = Table.SplitColumn(#"Переименованные столбцы1", "Уровень", Splitter.SplitTextByPositions({0, 2}, true), {"Уровень.1", "Уровень.2"}),
    #"Удаленные столбцы" = Table.RemoveColumns(#"Разделить столбец по положению",{"Уровень.1"}),
    #"Измененный тип" = Table.TransformColumnTypes(#"Удаленные столбцы",{{"Уровень.2", Int64.Type}}),
    #"Строки с примененным фильтром2" = Table.SelectRows(#"Измененный тип", each [Уровень.2] > 10),
    #"Разделить столбец по положению1" = Table.SplitColumn(#"Строки с примененным фильтром2", "Журнал", Splitter.SplitTextByRepeatedLengths(27), {"Журнал.1", "Журнал.2"}),
    #"Измененный тип1" = Table.TransformColumnTypes(#"Разделить столбец по положению1",{{"Журнал.1", type text}, {"Журнал.2", type text}}),
    #"Удаленные столбцы1" = Table.RemoveColumns(#"Измененный тип1",{"Журнал.1"}),
    #"Переименованные столбцы2" = Table.RenameColumns(#"Удаленные столбцы1",{{"Журнал.2", "Журнал."}}),
    #"Переупорядоченные столбцы" = Table.ReorderColumns(#"Переименованные столбцы2",{"Журнал.", "Артикул", "Наименование", "Адрес", "Количество", "Уровень.2"}),
    #"Сортированные строки" = Table.Sort(#"Переупорядоченные столбцы",{{"Журнал.", Order.Ascending}, {"Уровень.2", Order.Ascending}}),
    #"Переименованные столбцы3" = Table.RenameColumns(#"Сортированные строки",{{"Уровень.2", "Собрать"}}),
    #"Извлеченные первые символы" = Table.TransformColumns(#"Переименованные столбцы3", {{"Собрать", each Text.Start(Text.From(_, "ru-RU"), 0), type text}})
in
    #"Извлеченные первые символы"